<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.63">
<title data-react-helmet="true">Github Issues Viewer | React-RxJS</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Github Issues Viewer | React-RxJS"><meta data-react-helmet="true" name="description" content="This tutorial assumes you are already familiar with both RxJS and React."><meta data-react-helmet="true" property="og:description" content="This tutorial assumes you are already familiar with both RxJS and React."><meta data-react-helmet="true" property="og:url" content="https://react-rxjs.org/docs/tutorial/github-issues"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://react-rxjs.org/docs/tutorial/github-issues"><link rel="stylesheet" href="/styles.1283b01f.css">
<link rel="preload" href="/styles.d37faabd.js" as="script">
<link rel="preload" href="/runtime~main.154d0a03.js" as="script">
<link rel="preload" href="/main.799b1363.js" as="script">
<link rel="preload" href="/1.f3f24671.js" as="script">
<link rel="preload" href="/2.efa9d8d9.js" as="script">
<link rel="preload" href="/27.96bf24fa.js" as="script">
<link rel="preload" href="/28.9c7a2193.js" as="script">
<link rel="preload" href="/935f2afb.8a5ec3f3.js" as="script">
<link rel="preload" href="/17896441.9d830699.js" as="script">
<link rel="preload" href="/3dcf8b31.c6b24866.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo-128.png" alt="React-RxJS Logo"><strong class="navbar__title">React-RxJS</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/getting-started">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tutorial/github-issues">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/api/core/bind">API</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/re-rxjs/react-rxjs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo-128.png" alt="React-RxJS Logo"><strong class="navbar__title">React-RxJS</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/getting-started">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/tutorial/github-issues">Tutorial</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/api/core/bind">API</a></li><li class="menu__list-item"><a href="https://github.com/re-rxjs/react-rxjs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/motivation">Motivation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/core-concepts">Core Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/tutorial/github-issues">Github Issues Viewer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/tutorial/todos">Todo App</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API Reference</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Core</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/core/bind">bind()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/core/shareLatest">shareLatest()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/core/suspense">SUSPENSE</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/core/useSubscribe">useSubcribe()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/core/subscribe">&lt;Subscribe /&gt;</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Utils</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/collect">collect()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/collectValues">collectValues()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/mergeWithKey">mergeWithKey()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/selfDependant">selfDependant()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/split">split()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/suspend">suspend()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/suspended">suspended()</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api/utils/switchMapSuspended">switchMapSuspended()</a></li></ul></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Github Issues Viewer</h1></header><div class="markdown"><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Important</h5></div><div class="admonition-content"><p>This tutorial assumes you are already familiar with both RxJS and React.</p></div></div><p>For this tutorial we will be borrowing the <a href="https://redux-toolkit.js.org/tutorials/advanced-tutorial" target="_blank" rel="noopener noreferrer">Github issues example that is taught
in the Advanced Tutorial of the Redux Toolkit</a>.</p><p>It&#x27;s a great example because it starts with a plain React application and it then
shows how to migrate that application to Redux using the Redux Toolkit (RTK). One of the many good
things about the tutorial, is that it illustrates the mental models required to manage
state efficiently with RTK. In this tutorial we will try to follow the same approach.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reviewing-the-starting-example-application"></a>Reviewing the Starting Example Application<a aria-hidden="true" tabindex="-1" class="hash-link" href="#reviewing-the-starting-example-application" title="Direct link to heading">#</a></h2><p>The example application for this tutorial is a Github Issues viewer app. It allows
the user to enter the names of a Github org and repository, fetch the current list
of open issues, page through the issues list, and view the contents and comments
of a specific issue.</p><p>The starting commit for this application is a plain React implementation that uses
function components with hooks for state and side effects like data fetching. The
code is already written in TypeScript, and the styling is done via CSS Modules.</p><p>Let&#x27;s start by viewing the original plain React app in action:</p><iframe src="https://codesandbox.io/embed/github/re-rxjs/react-rxjs-github-issues-example/tree/plain-react?fontsize=14&amp;hidenavigation=1&amp;theme=dark&amp;view=preview" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="react-rxjs-github-issues-example-plain-react" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><p>It&#x27;s worth noting that there are a couple of tiny bugs (or annoyances) with this
React implementation:</p><ul><li><p>Changing the &quot;Issues Page&quot; number and jumping to that page will highlight the
pagination number on the footer. However, changing the pagination number through
the footer does not update the pagination number at the top.</p></li><li><p>When the user loads a different repo, the issues page doesn&#x27;t go back to the first page,
which is problematic: If the user was looking at page 5 of the initial repo
and then tries to go to a different repo which doesn&#x27;t have as many pages,
the results don&#x27;t load properly. We think that it would be desirable to go back
to the first page whenever the user loads a different repo.</p></li></ul><p>We will be addressing these issues as we migrate the initial code to React-RxJS.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="react-codebase-source-overview"></a>React Codebase Source Overview<a aria-hidden="true" tabindex="-1" class="hash-link" href="#react-codebase-source-overview" title="Direct link to heading">#</a></h3><p>The codebase is already laid out in a &quot;feature folder&quot; structure, The main pieces are:</p><ul><li><code>/api</code>: fetching functions and TS types for the Github Issues API</li><li><code>/app</code>: main <code>&lt;App&gt;</code> component</li><li><code>/components</code>: components that are reused in multiple places</li><li><code>/features</code><ul><li><code>/issueDetails:</code> components for the Issue Details page</li><li><code>/issuesList</code>: components for the Issues List display</li><li><code>/repoSearch</code>: components for the Repo Search form</li></ul></li><li><code>/utils</code>: various string utility functions</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="changing-the-dependencies"></a>Changing the dependencies<a aria-hidden="true" tabindex="-1" class="hash-link" href="#changing-the-dependencies" title="Direct link to heading">#</a></h3><p>For this tutorial we will need the following dependencies:</p><ul><li><code>rxjs</code>: since these are bindings for RxJS ðŸ˜„</li><li><code>@react-rxjs/core</code>: the core package of React-RxJS</li><li><code>react-error-boundary</code>: React-RxJS integrates very nicely with React Error
Boundaries. <code>react-error-boundary</code> is a tiny library that provides a nice
abstraction to build them, by declaring a fallback component and recovery strategy,
in a similar way to Suspense Boundaries.</li></ul><p>Also, we are not going to need Axios, because we will be using <code>rxjs/ajax</code> instead.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="refactor-api-axios---rxjs"></a>Refactor API: Axios -&gt; RxJS<a aria-hidden="true" tabindex="-1" class="hash-link" href="#refactor-api-axios---rxjs" title="Direct link to heading">#</a></h3><p>The original API uses Axios, which is a great tool for handling requests. We could
keep the API as it is, because RxJS can easily treat Promises as Observables.
However, since we are going to be using RxJS, it makes sense to use RxJS instead
of Axios. It&#x27;s a pretty straightforward change:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import axios from &#x27;axios&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { ajax } from &#x27;rxjs/ajax&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> import parseLink, { Links } from &#x27;parse-link-header&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { map, pluck } from &#x27;rxjs/operators&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+import { Observable } from &#x27;rxjs&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> export interface Label {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   id: number</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -64,47 +66,40 @@ const getPageCount = (pageLinks: Links) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export async function getIssues(</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export function getIssues(</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   org: string,</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   repo: string,</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   page = 1</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-): Promise&lt;IssuesResult&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+): Observable&lt;IssuesResult&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   const url = `https://api.github.com/repos/${org}/${repo}/issues?per_page=25&amp;page=${page}`</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  try {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    const issuesResponse = await axios.get&lt;Issue[]&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    let pageCount = 0</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    const pageLinks = parseLink(issuesResponse.headers.link)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    if (pageLinks !== null) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      pageCount = getPageCount(pageLinks)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    return {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      pageLinks,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      pageCount,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      issues: issuesResponse.data,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  } catch (err) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    throw err</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+  return ajax.get(url).pipe(</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    map((r) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      let pageCount = 0</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      const pageLinks = parseLink(r.xhr.getResponseHeader(&#x27;link&#x27;) as string)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      if (pageLinks !== null) {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+        pageCount = getPageCount(pageLinks)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      }</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      return {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+        pageLinks,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+        pageCount,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+        issues: r.response as Issue[],</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      }</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    })</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  )</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export async function getRepoDetails(org: string, repo: string) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export function getRepoOpenIssuesCount(org: string, repo: string) {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   const url = `https://api.github.com/repos/${org}/${repo}`</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const { data } = await axios.get&lt;RepoDetails&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  return data</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+  return ajax.getJSON&lt;RepoDetails&gt;(url).pipe(pluck(&#x27;open_issues_count&#x27;))</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export async function getIssue(org: string, repo: string, number: number) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export function getIssue(org: string, repo: string, number: number) {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   const url = `https://api.github.com/repos/${org}/${repo}/issues/${number}`</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const { data } = await axios.get&lt;Issue&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  return data</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+  return ajax.getJSON&lt;Issue&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export async function getComments(url: string) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const { data } = await axios.get&lt;Comment[]&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  return data</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export function getComments(url: string) {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  return ajax.getJSON&lt;Comment[]&gt;(url)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> }</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="identifying-the-state-of-the-app"></a>Identifying the state of the App<a aria-hidden="true" tabindex="-1" class="hash-link" href="#identifying-the-state-of-the-app" title="Direct link to heading">#</a></h2><p>Now that we have everything ready, let&#x27;s think for a moment about the state of
this app. Luckily for us, there is not a lot of it. So, let&#x27;s represent the different
state entities and their relations on a diagram:</p><img src="/img/github-issues-dependencies.png" alt="A diagram that represents the relations of the entities. At the top we have the user inputs,
followed by those states that depend on them directly. One level below we have those states
that depend on other states."><p>At the very top we have the different events that can happen. The 3 different user interactions:</p><ul><li>Changing the repo</li><li>Changing the page</li><li>Selecting / unselecting an issue</li></ul><p>These are the events that will propagate changes to our state entities.</p><p>Then we have the following state entities:</p><ul><li><p><strong>&quot;Current repo &amp; page&quot;</strong>: Since the page and the repo are very tightly coupled, it makes
sense to have an entity that represents the current state of the both of them. This entity
depends on 2 different user interactions: changing the repo and changing the page.</p></li><li><p>From this entity we can easily derive the <strong>&quot;list of issues&quot;</strong> and the <strong>&quot;current page&quot;</strong>.</p></li><li><p>We also have the <strong>&quot;# of open issues&quot;</strong> which depends on the &quot;changing repo&quot; event.</p></li><li><p>Then there is the <strong>&quot;issue details&quot;</strong> which will change whenever the user selects/unselects an issue.</p></li><li><p>And finally we have the <strong>&quot;issue comments&quot;</strong> which depend on the &quot;issue details&quot;.</p></li></ul><p>That&#x27;s it. That&#x27;s all the app-level state. It&#x27;s worth pointing out that the UI
doesn&#x27;t allow the user to change the repo or the page while there is a selected issue.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="defining-the-state-of-the-app"></a>Defining the state of the App<a aria-hidden="true" tabindex="-1" class="hash-link" href="#defining-the-state-of-the-app" title="Direct link to heading">#</a></h2><p>Now that we have identified the state, let&#x27;s represent it using RxJS streams, and
let&#x27;s create the necessary React hooks.</p><p>One nice thing about Reactive Programming is that it&#x27;s possible to declare state
in a way that reads from top to bottom. That&#x27;s because each state entity is only
coupled to the entities that it depends on.</p><p>In order to illustrate that, we will be putting all the state of this app in the
same file. Normally, it would be better to break this file down into smaller
pieces and to co-locate each piece closer to where it is being used.</p><p>Let&#x27;s first define and export the default states of the app:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">INITIAL_ORG</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rails&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">INITIAL_REPO</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rails&quot;</span></div></div></div></div></div><p>Next, let&#x27;s create the entry points for the user interactions:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> repoSubject$ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Subject</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> org</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onLoadRepo</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">org</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> string</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  repoSubject$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> org</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repo </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> pageSelected$ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Subject</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">number</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onPageChange</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">nextPage</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  pageSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nextPage</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> issueSelected$ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Subject</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token builtin">number</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onIssueSelected</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">id</span><span class="token parameter punctuation" style="color:#393A34">:</span><span class="token parameter"> number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issueSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onIssueUnselecteed</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issueSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><p>Now that we already have the top-level streams, let&#x27;s create a stream that represents
the &quot;current repo and page&quot; entity. We want to reset the page to 1 when the selected repo changes,
so we can represent this behavior with <code>merge</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useCurrentRepo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> currentRepo$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  repoSubject$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      org</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">INITIAL_ORG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      repo</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">INITIAL_REPO</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> currentRepoAndPage$ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// When repo changes, update repo and reset page to 1</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  repoSubject$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">currentRepo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">currentRepo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      page</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// When page changes</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  pageSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">page</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> page </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// keep same repo, update page</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">withLatestFrom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentRepo$</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">page</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain">repo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> page </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">shareLatest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>From this stream we can extract the current page:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useCurrentPage</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentRepoAndPage$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">pluck</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;page&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>And following our model, the list of issues also depends on this stream, but the
list of issues needs to be loaded from the API.</p><p>In this example we also want to use React Suspense: When the user changes the repo
or page, we want to show a suspended state while the new issue list is loading
(i.e. &quot;Loading issues...&quot;). The way we can do this, is by emitting the
<a href="/docs/api/core/suspense"><code>SUSPENSE</code></a> symbol, that means that there&#x27;s data being loaded in this stream.
This can be expressed reactively as:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useIssues</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> issues$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentRepoAndPage$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> page</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> org </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">getIssues</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> page</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>This way, every time the current repo or page changes, the <code>useIssues</code> hook
will send another query to the API to keep everything up to date, suspending the
component(s) that depend on it while it&#x27;s fetching the new values.</p><p>We can use the same pattern to retrieve the number of open issues:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useOpenIssuesLen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> openIssuesLen$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  currentRepo$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> org</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">getRepoOpenIssuesCount</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Now, since <code>issues$</code> and <code>openIssuesLen$</code> are observables that trigger side-effects,
it&#x27;s important that their initial subscriptions happen before react renders the
components that depend on them. That&#x27;s why we are going to define a top-level
subscription that ensures that.</p><p>We need to also make sure that an error won&#x27;t close this top-level subscription:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">currentRepoAndPage$</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMapTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">merge</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issues$</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> openIssuesLen$</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EMPTY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>And lastly we need to declare the state when an issue is selected: Following
similar logic, we need to load the issue details when an issue is selected,
as well as its comments:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useSelectedIssueId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> selectedIssueId$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issueSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useIssue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> issue$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  selectedIssueId$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token parameter">number</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">withLatestFrom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentRepo$</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">id</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> org</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">getIssue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useIssueComments</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> issueComments$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issue$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> issue </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token parameter">Issue</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> issue </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">issue</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getComments</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">comments_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>As this pattern of <code>switchMap</code> and <code>startWith(SUSPENSE)</code> is something that&#x27;s
often used, react-rxjs exports <a href="/docs/api/utils/switchMapSuspended"><code>switchMapSuspended</code></a>
in <code>@react-rxjs/utils</code> that makes it sightly less verbose.</p><p>Here we also need to create a subscription to <code>issueComments$</code> in order to ensure
that the first subscription happens before react renders the components that
depend on it. Notice that by just subscribing to <code>issueComment$</code>, all the streams
that depend on it will also get a subscription:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">selectedIssueId$</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">switchMapTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issueComments$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EMPTY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="wiring-things-up"></a>Wiring things up!<a aria-hidden="true" tabindex="-1" class="hash-link" href="#wiring-things-up" title="Direct link to heading">#</a></h2><p>Now that we have all the application state declared, we can wire it up
with the components.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="main-app-component"></a>Main App Component<a aria-hidden="true" tabindex="-1" class="hash-link" href="#main-app-component" title="Direct link to heading">#</a></h3><p>The <a href="https://github.com/re-rxjs/react-rxjs-github-issues-example/commit/d3932f4cf64943e831fc710638669ce3fca75d84#diff-34456421648850188ad56fcd6df47b2b" target="_blank" rel="noopener noreferrer">diff of this component is so brutal</a>
that it&#x27;s best to show how the code looks with react-rxjs:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Suspense</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lazy </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./App.css&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">RepoSearchForm</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;features/repoSearch/RepoSearchForm&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssuesListPage</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;features/issuesList/IssuesListPage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssuesDetailsPage</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;features/issueDetails/IssueDetailsPage&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> useSelectedIssueId </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;state&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">List</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useSelectedIssueId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">RepoSearchForm</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssuesListPage</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">App</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">List</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">fallback</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript keyword" style="color:#00009f">null</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssueDetailsPage</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token maybe-class-name">App</span></div></div></div></div></div><p>With Suspense, we don&#x27;t need to manage the loading states by ourselves - React
will. This, coupled with the fact that the state can be lifted out, allows us to simplify
the original app to a couple of simple components.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reposearchform"></a>RepoSearchForm<a aria-hidden="true" tabindex="-1" class="hash-link" href="#reposearchform" title="Direct link to heading">#</a></h3><p>For the &quot;search repository&quot; form, by having the state in a separate file, we can
just import those bits that we need directly, and this way the parent doesn&#x27;t
need to get coupled to values that it doesn&#x27;t need:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import React, { useState, ChangeEvent } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import React, { useState, ChangeEvent, useEffect } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import &#x27;./pure-forms.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import &#x27;./pure-buttons.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-interface Props {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  org: string</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  repo: string</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  setOrgAndRepo: (org: string, repo: string) =&gt; void</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  setJumpToPage: (page: number) =&gt; void</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  useCurrentPage,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  onLoadRepo,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  onPageChange,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  INITIAL_REPO,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  INITIAL_ORG,</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+} from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> type InputEvent = ChangeEvent&lt;HTMLInputElement&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> type ChangeHandler = (e: InputEvent) =&gt; void</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export const RepoSearchForm = ({</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  org,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  repo,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  setOrgAndRepo,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  setJumpToPage,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}: Props) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const [currentOrg, setCurrentOrg] = useState(org)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const [currentRepo, setCurrentRepo] = useState(repo)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  const [currentPageText, setCurrentPageText] = useState(&#x27;1&#x27;)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export const RepoSearchForm: React.FC = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const [currentOrg, setCurrentOrg] = useState(INITIAL_ORG)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const [currentRepo, setCurrentRepo] = useState(INITIAL_REPO)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const page = useCurrentPage()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const [currentPageText, setCurrentPageText] = useState(page.toString())</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  useEffect(() =&gt; setCurrentPageText(page.toString()), [page])</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   const onOrgChanged: ChangeHandler = (e) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     setCurrentOrg(e.target.value)</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -36,14 +33,14 @@ export const RepoSearchForm = ({</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   const onLoadRepoClicked = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-    setOrgAndRepo(currentOrg, currentRepo)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+    onLoadRepo(currentOrg, currentRepo)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   const onJumpToPageClicked = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     const newPage = parseInt(currentPageText)</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">     if (newPage &gt;= 1) {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-      setJumpToPage(newPage)</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+      onPageChange(newPage)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">     }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   }</span></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issueslistpage"></a>IssuesListPage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issueslistpage" title="Direct link to heading">#</a></h3><p>The page for the list of issues is also <a href="https://github.com/re-rxjs/react-rxjs-github-issues-example/commit/d3932f4cf64943e831fc710638669ce3fca75d84#diff-86b21025fd105e75d28d28541f8288b5" target="_blank" rel="noopener noreferrer">greatly simplified</a>,
because all the state management on this part is already done, and it turns out
that this component is not the consumer of any of the state it managed - The
consumers are their children, which will access whatever they need themselves.</p><p>This component still has a responsibility though: to catch any error that would
happen on fetch, and show a fallback UI. React-RxJS lets us use ErrorBoundaries,
not only for the regular errors that happen within React&#x27;s Components, but also
for those errors that are generated in a stream.</p><p>What will happen is that, if a component uses a stream that emits an error, it
will propagate that error to the nearest error boundary. If that happens, the
Error Boundary will show the fallback UI, and we can decide how to recover. In
our case, we want to show the components when the user selects another
repository or another page, so we can set this up easily by using a <code>useEffect</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> useEffect </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">ErrorBoundary</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">FallbackProps</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react-error-boundary&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssuesPageHeader</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssuesPageHeader&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssuesList</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssuesList&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssuePagination</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssuePagination&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> currentRepoAndPage$ </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;state&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> skip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> take </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs/operators&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token known-class-name class-name">OnError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FC</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">FallbackProps</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> error</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> resetErrorBoundary </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> subscription </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> currentRepoAndPage$</span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">skip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">take</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resetErrorBoundary</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> subscription</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unsubscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">resetErrorBoundary</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Something</span><span class="token plain"> went wrong</span><span class="token operator" style="color:#393A34">...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">error </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">IssuesListPage</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">FallbackComponent</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript known-class-name class-name" style="color:#00009f">OnError</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">issue-list-page</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssuesPageHeader</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssuesList</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssuePagination</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issuespageheader"></a>IssuesPageHeader<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issuespageheader" title="Direct link to heading">#</a></h4><p>For the header, we can get rid of its props (as we have already declared its state),
and we will also take the chance to represent the loading state by
using React&#x27;s Suspense:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import React, { Suspense } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+import { useCurrentRepoOpenIssuesCount, useCurrentRepo } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-interface OrgProps {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  org: string</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  repo: string</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-type HeaderProps = {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  openIssuesCount: number</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-} &amp; OrgProps</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-function OrgRepo({ org, repo }: OrgProps) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+function OrgRepo() {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const { org, repo } = useCurrentRepo()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   return (</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;span&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">       &lt;a href={`https://github.com/${org}`} className=&quot;header__org&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -23,24 +16,23 @@ function OrgRepo({ org, repo }: OrgProps) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   )</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export function IssuesPageHeader({</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  openIssuesCount = -1,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  org,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  repo,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}: HeaderProps) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  if (openIssuesCount === -1) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    return (</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-        Open issues for &lt;OrgRepo org={org} repo={repo} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;/h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    )</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  } else {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    const pluralizedIssue = openIssuesCount === 1 ? &#x27;issue&#x27; : &#x27;issues&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    return (</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-        &lt;span className=&quot;header__openIssues&quot;&gt;{openIssuesCount}&lt;/span&gt; open{&#x27; &#x27;}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-        {pluralizedIssue} for &lt;OrgRepo org={org} repo={repo} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;/h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    )</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+function OpenIssues() {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const openIssuesCount = useCurrentRepoOpenIssuesCount()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  return (</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;span className=&quot;header__openIssues&quot;&gt;{openIssuesCount}&lt;/span&gt; open{&#x27; &#x27;}</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      {openIssuesCount === 1 ? &#x27;issue&#x27; : &#x27;issues&#x27;} for {}</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;/&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  )</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+}</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+export function IssuesPageHeader() {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  return (</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;Suspense fallback={&#x27;Open issues for &#x27;}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+        &lt;OpenIssues /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;/Suspense&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;OrgRepo /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;/h1&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  )</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> }</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issuepagination"></a>IssuePagination<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issuepagination" title="Direct link to heading">#</a></h4><p>The same logic applies for the pagination component:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import React, { Suspense } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> import classnames from &#x27;classnames&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import Paginate, { ReactPaginateProps } from &#x27;react-paginate&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import Paginate from &#x27;react-paginate&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import styles from &#x27;./IssuePagination.module.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import &#x27;./IssuePagination.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { useCurrentPage, useIssues, onPageChange } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export type OnPageChangeCallback = ReactPaginateProps[&#x27;onPageChange&#x27;]</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-interface Props {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  currentPage: number</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  pageCount: number</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  onPageChange?: OnPageChangeCallback</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-export const IssuePagination = ({</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  currentPage,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  pageCount,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  onPageChange,</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}: Props) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+const IssuePaginationLoaded = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const currentPage = useCurrentPage() - 1</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const { pageCount } = useIssues()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-  return (</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+  return pageCount === 0 ? null : (</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">     &lt;div className={classnames(&#x27;issuesPagination&#x27;, styles.pagination)}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">       &lt;Paginate</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">         forcePage={currentPage}</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">         pageCount={pageCount}</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">         marginPagesDisplayed={2}</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">         pageRangeDisplayed={5}</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-        onPageChange={onPageChange}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+        onPageChange={({ selected }) =&gt; onPageChange(selected + 1)}</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">         nextLabel=&quot;&amp;rarr;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">         previousLabel=&quot;&amp;larr;&quot;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">       /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;/div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   )</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+export const IssuePagination = () =&gt; (</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  &lt;Suspense fallback={null}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;IssuePaginationLoaded /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  &lt;/Suspense&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+)</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issueslist"></a>IssuesList<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issueslist" title="Direct link to heading">#</a></h4><p>And the list:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import React, { Suspense } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import { Issue } from &#x27;api/githubAPI&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token unchanged"> import { IssueListItem } from &#x27;./IssueListItem&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import styles from &#x27;./IssuesList.module.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { useIssues } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-interface Props {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  issues: Issue[]</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  showIssueComments: (issueId: number) =&gt; void</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-export const IssuesList = ({ issues, showIssueComments }: Props) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+const IssuesListLoaded = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const { issues } = useIssues()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   const renderedIssues = issues.map((issue) =&gt; (</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;li key={issue.id}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;IssueListItem {...issue} showIssueComments={showIssueComments} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;IssueListItem {...issue} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">     &lt;/li&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   ))</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   return &lt;ul className={styles.issuesList}&gt;{renderedIssues}&lt;/ul&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+export const IssuesList = () =&gt; (</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  &lt;Suspense fallback={&lt;div&gt;Loading...&lt;/div&gt;}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;IssuesListLoaded /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  &lt;/Suspense&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+)</span></div></div></div></div></div><p>When react renders <code>IssuesListLoaded</code>, it will call <code>useIssues()</code>,
which internally will subscribe to the stream, and start fetching the value
from GitHub&#x27;s API. As that value won&#x27;t be resolved immediately, the component
will be put in suspense until we get a response back from the server.</p><p>At that point, the component will exit suspense and <code>issues</code> will have
the value expected.</p><p>Then, when the user changes to another repo or page, <code>useIssues()</code> will put
the component in suspense again until the new request has loaded.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issuedetailspage"></a>IssueDetailsPage<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issuedetailspage" title="Direct link to heading">#</a></h3><p>Here, by also using error boundaries and suspense, we can break down this
component into smaller ones. There are <a href="https://github.com/re-rxjs/react-rxjs-github-issues-example/commit/d3932f4cf64943e831fc710638669ce3fca75d84#diff-1a799039b78ec6f0b5ab3f324755c673" target="_blank" rel="noopener noreferrer">too many changes</a>
to be able to follow this, but the result would be:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-tsx codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Suspense</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token maybe-class-name">ReactMarkdown</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react-markdown&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> classnames </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;classnames&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> insertMentionLinks </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;utils/stringUtils&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssueLabels</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;components/IssueLabels&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssueMeta</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssueMeta&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">IssueComments</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssueComments&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> styles </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssueDetailsPage.module.css&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./IssueDetailsPage.css&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">ErrorBoundary</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">FallbackProps</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;react-error-boundary&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> onIssueUnselecteed</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> useIssue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> useSelectedIssueId </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;state&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Comments</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> comments </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useIssue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> comments </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">issue-detail--no-comments</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token maybe-class-name">No</span><span class="token plain"> comments</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">      </span><span class="token tag attr-name" style="color:#00a4db">fallback</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">        </span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;</span><span class="token tag script language-javascript tag" style="color:#00009f">div</span><span class="token tag script language-javascript tag" style="color:#00009f"> </span><span class="token tag script language-javascript tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag script language-javascript tag attr-value" style="color:#e3116c">issue-detail--comments-loading</span><span class="token tag script language-javascript tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript maybe-class-name" style="color:#00009f">Coments</span><span class="token tag script language-javascript" style="color:#00009f"> loading</span><span class="token tag script language-javascript operator" style="color:#393A34">...</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag script language-javascript tag" style="color:#00009f">div</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">      </span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssueComments</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">BackButton</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">button</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">pure-button</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">onIssueUnselecteed</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Back</span><span class="token plain"> to </span><span class="token maybe-class-name">Issues</span><span class="token plain"> </span><span class="token maybe-class-name">List</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">button</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">IssueDetails</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> issue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useIssue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript function" style="color:#d73a49">classnames</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript string" style="color:#e3116c">&quot;issueDetailsPage&quot;</span><span class="token tag script language-javascript punctuation" style="color:#393A34">,</span><span class="token tag script language-javascript" style="color:#00009f"> styles</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">issueDetailsPage</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">issue-detail__title</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">issue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">BackButton</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssueMeta</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">issue</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">issue</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssueLabels</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">labels</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">issue</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">labels</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">styles</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">issueLabels</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hr</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">styles</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">divider</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">styles</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">summary</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ReactMarkdown</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">          </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript string" style="color:#e3116c">&quot;testing&quot;</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">          </span><span class="token tag attr-name" style="color:#00a4db">source</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript function" style="color:#d73a49">insertMentionLinks</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript" style="color:#00009f">issue</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">body</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">hr</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">styles</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">divider</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Loading</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> children </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">className</span><span class="token tag attr-value punctuation" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">issue-detail--loading</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">BackButton</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token known-class-name class-name">IssueError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FC</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">FallbackProps</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> error </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Loading</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Something</span><span class="token plain"> went wrong</span><span class="token operator" style="color:#393A34">...</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">error</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Loading</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">Issue</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FC</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">number</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> id </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">FallbackComponent</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript known-class-name class-name" style="color:#00009f">IssueError</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">          </span><span class="token tag attr-name" style="color:#00a4db">fallback</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">            </span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;</span><span class="token tag script language-javascript tag class-name" style="color:#00009f">Loading</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">              </span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;</span><span class="token tag script language-javascript tag" style="color:#00009f">p</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript maybe-class-name" style="color:#00009f">Loading</span><span class="token tag script language-javascript" style="color:#00009f"> issue #</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">id</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag script language-javascript operator" style="color:#393A34">...</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag script language-javascript tag" style="color:#00009f">p</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">            </span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag script language-javascript tag class-name" style="color:#00009f">Loading</span><span class="token tag script language-javascript tag punctuation" style="color:#393A34">&gt;</span><span class="token tag script language-javascript" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag script language-javascript" style="color:#00009f">          </span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span></div><div class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">        </span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">IssueDetails</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Comments</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Suspense</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">ErrorBoundary</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">IssueDetailsPage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function maybe-class-name" style="color:#d73a49">FC</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useSelectedIssueId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Issue</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">id</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">id</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token maybe-class-name">IssueDetailsPage</span></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="issuecomments"></a>IssueComments<a aria-hidden="true" tabindex="-1" class="hash-link" href="#issuecomments" title="Direct link to heading">#</a></h4><p>And lastly for the comments of the selected issue, we can also just grab the
hook from where we declared the state and use it. Because of Suspense, we again
don&#x27;t need to handle the loading case.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token unchanged"> import ReactMarkdown from &#x27;react-markdown&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import { insertMentionLinks } from &#x27;utils/stringUtils&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import { Issue, Comment } from &#x27;api/githubAPI&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { Comment } from &#x27;api/githubAPI&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> import { UserWithAvatar } from &#x27;components/UserWithAvatar&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import styles from &#x27;./IssueComments.module.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-interface ICLProps {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  issue: Issue</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  comments: Comment[]</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-}</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { useIssueComments } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> interface ICProps {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   comment: Comment</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -35,20 +31,8 @@ function IssueComment({ comment }: ICProps) {</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   )</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export function IssueComments({ comments = [], issue }: ICLProps) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  // The issue has no comments</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  if (issue.comments === 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    return &lt;div className=&quot;issue-detail--no-comments&quot;&gt;No comments&lt;/div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  // The issue has comments, but they&#x27;re not loaded yet</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  if (!comments || comments.length === 0) {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    return (</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-      &lt;div className=&quot;issue-detail--comments-loading&quot;&gt;Comments loading...&lt;/div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-    )</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  }</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-  // Comments are loaded</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+export const IssueComments: React.FC = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  const comments = useIssueComments()</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   return (</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;ul className={styles.commentsList}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">       {comments.map((comment) =&gt; (</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="summary"></a>Summary<a aria-hidden="true" tabindex="-1" class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>The result of this tutorial can be seen in this CodeSandbox:</p><iframe src="https://codesandbox.io/embed/github/re-rxjs/react-rxjs-github-issues-example/tree/master?fontsize=14&amp;hidenavigation=1&amp;theme=dark&amp;view=editor&amp;module=%2Fsrc%2Fstate.ts" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="react-rxjs-github-issues-example" allow="geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe><p>With this, we&#x27;ve managed to:</p><ul><li>Showcase an example of an application that deals with service calls.</li><li>Have the application state declared reactively. This implies:<ul><li>We can read the state definition top-to-bottom.</li><li>Every piece of the state declares how it behaves.</li></ul></li><li>Solved both of the issues that the original example had on synchronizing
states.</li><li>Used two of the newest React techniques to declare loading and error states.</li><li>Reduce boilerplate: the net diff shows a negative number of lines.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bonus-code-splitting"></a>Bonus: Code splitting<a aria-hidden="true" tabindex="-1" class="hash-link" href="#bonus-code-splitting" title="Direct link to heading">#</a></h2><p>As another advantage, it&#x27;s worth noting that in this example we&#x27;ve decided to
keep all the state defined in a single file: The example is small
enough, and it&#x27;s easier to explain this way. However, in a real application you can split
and co-locate the state in each of the relevant parts of your application, and it
will play nicely with code-splitting, if you were to use lazy imports. Let&#x27;s
quickly try this to see how it plays a big role in load time.</p><p>For this example, one part of the application that can be split from the main
app is the page for issue details: It won&#x27;t be needed until the user
clicks on one of the issues, so it&#x27;s a perfect starting point.</p><p>With React-RxJS we can just move the streams that are only used by that page
into a separate file. Let&#x27;s put it next to where it will be used, the
<code>IssuesDetailsPage</code> and <code>IssuesComments</code> components:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-ts codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EMPTY</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  startWith</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  withLatestFrom</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  filter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  switchMapTo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  catchError</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  switchMap</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rxjs/operators&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> bind</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;@react-rxjs/core&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token maybe-class-name">Issue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> getIssue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> getComments </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;api/githubAPI&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> issueSelected$</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> selectedIssueId$</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> currentRepo$ </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;state&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">onIssueUnselecteed</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issueSelected$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">next</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useIssue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> issue$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  selectedIssueId$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token parameter">number</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">withLatestFrom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">currentRepo$</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter">id</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> org</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> repo </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">getIssue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">org</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> repo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">useIssueComments</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> issueComments$</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">bind</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  issue$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> issue </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token parameter">Issue</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> issue </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">switchMap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">issue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">getComments</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issue</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">comments_url</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">startWith</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SUSPENSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">selectedIssueId$</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">switchMapTo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">issueComments$</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">pipe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">catchError</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">EMPTY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span></div></div></div></div></div><p>Then we only need to update the imports for those components to use the above file
instead:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">@@ -6,7 +6,7 @@ import { Comment } from &#x27;api/githubAPI&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import { UserWithAvatar } from &#x27;components/UserWithAvatar&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import styles from &#x27;./IssueComments.module.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import { useIssueComments } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { useIssueComments } from &#x27;./state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> interface ICProps {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   comment: Comment</span></div></div></div></div></div><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token plain">@@ -11,7 +11,8 @@ import { IssueComments } from &#x27;./IssueComments&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> import styles from &#x27;./IssueDetailsPage.module.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import &#x27;./IssueDetailsPage.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import { ErrorBoundary, FallbackProps } from &#x27;react-error-boundary&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import { onIssueUnselecteed, useIssue, useSelectedIssueId } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import { onIssueUnselecteed, useIssue } from &#x27;./state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+import { useSelectedIssueId } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> const Comments: React.FC = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   const { comments } = useIssue()</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -87,7 +88,9 @@ const Issue: React.FC&lt;{ id: number }&gt; = ({ id }) =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged">   )</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted" style="color:#d73a49">-export const IssueDetailsPage: React.FC = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+const IssueDetailsPage: React.FC = () =&gt; {</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   const id = useSelectedIssueId()</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   return id === null ? null : &lt;Issue id={id} /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> }</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+export default IssueDetailsPage</span></div></div></div></div></div><p>And use a lazy import with Suspense in App:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-diff codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#393A34;background-color:#f6f8fa"><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49">-import React from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+import React, { lazy, Suspense } from &#x27;react&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> import &#x27;./App.css&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import { RepoSearchForm } from &#x27;features/repoSearch/RepoSearchForm&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> import { IssuesListPage } from &#x27;features/issuesList/IssuesListPage&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-import { IssueDetailsPage } from &#x27;features/issueDetails/IssueDetailsPage&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token unchanged"> import { useSelectedIssueId } from &#x27;state&#x27;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token inserted-sign inserted" style="color:#36acaa">+const IssueDetailsPage = lazy(</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+  () =&gt; import(&#x27;features/issueDetails/IssueDetailsPage&#x27;)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+)</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged"> const List: React.FC = () =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   useSelectedIssueId() === null ? (</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token plain">@@ -16,7 +19,9 @@ const List: React.FC = () =&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged"> const App: React.FC = () =&gt; (</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">   &lt;div className=&quot;App&quot;&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged">     &lt;List /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"></span><span class="token deleted-sign deleted" style="color:#d73a49">-    &lt;IssueDetailsPage /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token deleted-sign deleted" style="color:#d73a49"></span><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;Suspense fallback={null}&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+      &lt;IssueDetailsPage /&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa">+    &lt;/Suspense&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token inserted-sign inserted" style="color:#36acaa"></span><span class="token unchanged">   &lt;/div&gt;</span></div><div class="token-line" style="color:#393A34"><span class="token unchanged"> )</span></div></div></div></div></div><p>Now let&#x27;s compare the speed between the original version without code splitting
and the one that we have optimised with React-RxJS. Looking at the
Chrome Network tab with 3G for react-state:</p><img src="/img/react-state-network-size.png" alt="A screenshot of Chrome&#x27;s Network tab for react-state. Shows the main
waterfall chunk is a JS file of 76.8kB (240kB uncompressed), taking 3.71s to
load"><p>We see that the chunk that prevents the application from starting until it&#x27;s
completely loaded weighs 76.8kB compressed (240kB uncompressed), and it took
3.71s to load. And if we take a look at the same tab for React-RxJS with code
splitting:</p><img src="/img/react-rxjs-network-size.png" alt="A screenshot of Chrome&#x27;s Network tab for react-state. Shows the main
waterfall chunk is a JS file of 58.6kB (193kB uncompressed), taking 3.31s to
load"><p>We can see that it weighs less, and so it also takes less time to load: About
20kB (40kB uncompressed) less and 12% faster. Although we didn&#x27;t move 40kB of
minified code into a separate chunk, we reached this value because webpack
performs tree-shaking. This means that things like the 2 API calls
that are only done from the <code>IssuesDetailsPage</code> component, or the RxJS operators
that are only being used for the <code>IssuesDetailsPage</code>, were also excluded from
the main chunk.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/re-rxjs/react-rxjs.org/tree/master/docs/tutorial/github-issues.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Getting Started</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/tutorial/todos"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Todo App Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#reviewing-the-starting-example-application" class="table-of-contents__link">Reviewing the Starting Example Application</a><ul><li><a href="#react-codebase-source-overview" class="table-of-contents__link">React Codebase Source Overview</a></li><li><a href="#changing-the-dependencies" class="table-of-contents__link">Changing the dependencies</a></li><li><a href="#refactor-api-axios---rxjs" class="table-of-contents__link">Refactor API: Axios -&gt; RxJS</a></li></ul></li><li><a href="#identifying-the-state-of-the-app" class="table-of-contents__link">Identifying the state of the App</a></li><li><a href="#defining-the-state-of-the-app" class="table-of-contents__link">Defining the state of the App</a></li><li><a href="#wiring-things-up" class="table-of-contents__link">Wiring things up!</a><ul><li><a href="#main-app-component" class="table-of-contents__link">Main App Component</a></li><li><a href="#reposearchform" class="table-of-contents__link">RepoSearchForm</a></li><li><a href="#issueslistpage" class="table-of-contents__link">IssuesListPage</a></li><li><a href="#issuedetailspage" class="table-of-contents__link">IssueDetailsPage</a></li></ul></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li><li><a href="#bonus-code-splitting" class="table-of-contents__link">Bonus: Code splitting</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/core-concepts/">Core Concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api/core/bind/">API Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/react-rxjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/ReactRxJS" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/re-rxjs/react-rxjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.d37faabd.js"></script>
<script src="/runtime~main.154d0a03.js"></script>
<script src="/main.799b1363.js"></script>
<script src="/1.f3f24671.js"></script>
<script src="/2.efa9d8d9.js"></script>
<script src="/27.96bf24fa.js"></script>
<script src="/28.9c7a2193.js"></script>
<script src="/935f2afb.8a5ec3f3.js"></script>
<script src="/17896441.9d830699.js"></script>
<script src="/3dcf8b31.c6b24866.js"></script>
</body>
</html>